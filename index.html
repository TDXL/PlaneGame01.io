<!DOCTYPE html>
<html>
<head lang="en">
  <meta charset="UTF-8">
  <title></title>
  <style>
    * {
      margin: 0;
      padding: 0;
    }

    #map {
      width: 300px;
      height: 500px;
      background-color: #ccc;
      border: 1px solid #404060;
      position: relative;
      /*margin: 0 auto;*/
      overflow: hidden;
    }

    #map div {
      position: absolute;
    }

    #map > p {
      font: 60px/500px '黑体';
      width: 300px;
      text-align: center;
      color: red;
      position: absolute;
      z-index: 10;
      background-color: #ccc;
    }

    p.active {
      display: none;
    }

    #btn, #stop {
      width: 100px;
      height: 40px;
      font-size: 20px;
      margin: 20px;
    }

    #record {
      width: 200px;
      height: 40px;
      position: absolute;
      /*left: 100px;*/
      z-index: 11;
    }

    #record p {
      font-size: 20px;
      line-height: 20px;
      color: red;
    }

    #scare, #live {
      text-align: center;
    }
  </style>
</head>
<body>
<div id="map"><p>飞机大战</p>

  <div id="record">
    <p>分数：<span id="scare">0</span></p>

    <p>生命：<span id="live">♥♥♥</span></p>
  </div>
</div>
<button id="btn">开始游戏</button>
<button id="stop">暂停</button>
<script>
  //1 地图
  (function () {
    function Map() {

    }

    Map.prototype.init = function () {

    };
    window.Map = Map;
  }());
  //2 飞机
  (function () {
    function Plane(options) {
      this.width = options.width || 5;
      this.height = options.height || 5;
      this.body = [
        {x: 26, y: 0 + 84},
        {x: 26, y: 1 + 84},
        {x: 26, y: 2 + 84},
        {x: 26, y: 3 + 84},
        {x: 26, y: 4 + 84},
        {x: 26, y: 5 + 84},
        {x: 26, y: 6 + 84},
        {x: 26, y: 7 + 84},
        {x: 26, y: 8 + 84},
        {x: 26, y: 9 + 84},
        {x: 26, y: 10 + 84},
        {x: 26, y: 11 + 84},
        {x: 26, y: 12 + 84},
        {x: 26, y: 13 + 84},
        {x: 26, y: 14 + 84},
        {x: 25, y: 1 + 84},
        {x: 27, y: 1 + 84},
        {x: 25, y: 2 + 84},
        {x: 27, y: 2 + 84},
        {x: 24, y: 3 + 84},
        {x: 25, y: 3 + 84},
        {x: 27, y: 3 + 84},
        {x: 28, y: 3 + 84},
        {x: 23, y: 4 + 84},
        {x: 24, y: 4 + 84},
        {x: 25, y: 4 + 84},
        {x: 27, y: 4 + 84},
        {x: 28, y: 4 + 84},
        {x: 29, y: 4 + 84},
        {x: 22, y: 5 + 84},
        {x: 23, y: 5 + 84},
        {x: 24, y: 5 + 84},
        {x: 25, y: 5 + 84},
        {x: 27, y: 5 + 84},
        {x: 28, y: 5 + 84},
        {x: 29, y: 5 + 84},
        {x: 30, y: 5 + 84},
        {x: 21, y: 6 + 84},
        {x: 22, y: 6 + 84},
        {x: 23, y: 6 + 84},
        {x: 24, y: 6 + 84},
        {x: 25, y: 6 + 84},
        {x: 27, y: 6 + 84},
        {x: 28, y: 6 + 84},
        {x: 29, y: 6 + 84},
        {x: 30, y: 6 + 84},
        {x: 31, y: 6 + 84},
        {x: 20, y: 7 + 84},
        {x: 21, y: 7 + 84},
        {x: 22, y: 7 + 84},
        {x: 23, y: 7 + 84},
        {x: 24, y: 7 + 84},
        {x: 25, y: 7 + 84},
        {x: 27, y: 7 + 84},
        {x: 28, y: 7 + 84},
        {x: 29, y: 7 + 84},
        {x: 30, y: 7 + 84},
        {x: 31, y: 7 + 84},
        {x: 32, y: 7 + 84},
        {x: 25, y: 8 + 84},
        {x: 27, y: 8 + 84},
        {x: 25, y: 9 + 84},
        {x: 27, y: 9 + 84},
        {x: 25, y: 10 + 84},
        {x: 27, y: 10 + 84},
        {x: 25, y: 11 + 84},
        {x: 27, y: 11 + 84},
        {x: 24, y: 12 + 84},
        {x: 25, y: 12 + 84},
        {x: 27, y: 12 + 84},
        {x: 28, y: 12 + 84},
        {x: 23, y: 13 + 84},
        {x: 24, y: 13 + 84},
        {x: 25, y: 13 + 84},
        {x: 27, y: 13 + 84},
        {x: 28, y: 13 + 84},
        {x: 29, y: 13 + 84},
        {x: 22, y: 14 + 84},
        {x: 23, y: 14 + 84},
        {x: 24, y: 14 + 84},
        {x: 25, y: 14 + 84},
        {x: 27, y: 14 + 84},
        {x: 28, y: 14 + 84},
        {x: 29, y: 14 + 84},
        {x: 30, y: 14 + 84},
      ];
      this.elements = [];
      this.planeBollets_elements = [];
      this.map = options.map;
      this.direction = '';
      this.live = 3;
    }

    Plane.prototype.init = function (bgcolor, die) {
//      console.log('新飞机');
      if (die) {
        this.live--;
        var live = document.getElementById('live');
        live.innerText = '';
        for (var i = this.live; i > 0; i--) {
          live.innerText += '♥';
        }
        if (this.live == 0) {
          console.log('游戏结束');
          var p = document.getElementsByTagName('p')[0];
          p.className = '';
          p.innerText = 'GAME OVER';
          for (var i = this.elements.length - 1; i >= 0; i--) {
            this.map.removeChild(this.elements[i]);
          }
          this.elements = [];
//          this.body = [];
          if (this.planeBollets_elements != []) {
//        console.log(this.planeBollets_elements);
            for (var i = this.planeBollets_elements.length - 1; i >= 0; i--) {
//          this.map.removeChild(this.planeBollets_elements[i]);
              this.planeBollets_elements[i].remove();
//      setInterval(planeBolletMove(play1.plane.planeBollets_elements),1000);
            }
            this.planeBollets_elements = [];
          }
          play1.plane.bollet('die');
          play1.direction('die');
          play1.hinder.move('die');
          play1.init('[]');

//          play1.hinder.body = [];
//          play1.plane.bollet('die');
//          play1.hinder.move('die');
//          play1.prototype.position('die');

          clearInterval(planeMoveNum);
          clearInterval(planeGiveNum);
        } else {
          clearInterval(planeGiveNum);
          //setInterval(planeBolletMove(planeBollets),1000);
          play1.plane.bollet();
        }

      }
      //检查地图上是否有飞机
      if (this.elements != []) {
        for (var i = this.elements.length - 1; i >= 0; i--) {
          this.map.removeChild(this.elements[i]);
        }
        this.elements = [];
      }

      //绘制飞机
      for (var i = 0; i < this.body.length; i++) {
        var planeBody = document.createElement('div');
        planeBody.style.width = this.width + 'px';
        planeBody.style.height = this.height + 'px';
        planeBody.style.backgroundColor = bgcolor || '#666';
        planeBody.style.left = this.body[i].x * this.width + 'px';
        planeBody.style.top = this.body[i].y * this.height + 'px';
        var map = document.getElementById('map');
        map.appendChild(planeBody);
        this.elements.push(planeBody);
      }

//      this.bollet();
    };
    Plane.prototype.move = function (die) {
      //var planeBody = this.body;
//      console.log(this.direction);
      if (!die && this.body != []) {
        switch (this.direction) {
          case 'left':
//            console.log('左');
            if (this.body[0].x > 6) {
              for (var i = 0; i < this.body.length; i++) {
                this.body[i].x = this.body[i].x - 1;
              }
            }
            break;
          case 'up':
            if (this.body[0].y > 10) {
              for (var i = 0; i < this.body.length; i++) {
                this.body[i].y = this.body[i].y - 1;
              }
            }
            break;
          case 'right':
            if (this.body[0].x < 53) {
              for (var i = 0; i < this.body.length; i++) {
                this.body[i].x = this.body[i].x + 1;
              }
            }
            break;
          case 'down':
            if (this.body[0].y < 85) {
              for (var i = 0; i < this.body.length; i++) {
                this.body[i].y = this.body[i].y + 1;
              }
            }
            break;
        }
        this.init();
      }

    };
    //创建飞机子弹
    Plane.prototype.bollet = function (die) {
//      if(planeNum){
//        console.log('planeNum');
//        clearInterval(planeNum);
//      }
      //检查地图上是否有子弹
      if (this.planeBollets_elements != []) {
//        console.log(this.planeBollets_elements);
        for (var i = this.planeBollets_elements.length - 1; i >= 0; i--) {
//          this.map.removeChild(this.planeBollets_elements[i]);
          this.planeBollets_elements[i].remove();
//      setInterval(planeBolletMove(play1.plane.planeBollets_elements),1000);
        }
        this.planeBollets_elements = [];
      }

      if (die) {
        console.log('进入die');
        planeBolletMove = function () {
          clearInterval(planeGiveNum);
//          clearInterval(planeMoveNum);
        }
        this.bollet();
      } else {
        var planeBody0 = this.body[0];
        var planeBodyWidth = this.width;
        var planeBodyHeight = this.height;
        var planeBollets = [];
//      window.PlaneBollets = planeBollets;
        //创建飞机子弹
        var planeGiveNum = setInterval(function () {
//          console.log(this.body);
          var planeBollet = document.createElement('div');
          planeBollet.style.width = planeBodyWidth + 'px';
          planeBollet.style.height = planeBodyHeight + 'px';
          planeBollet.style.backgroundColor = '#999';
          planeBollet.style.left = planeBody0.x * planeBodyWidth + 'px';
          planeBollet.style.top = planeBody0.y * planeBodyHeight + 'px';
          var map = document.getElementById('map');
          map.appendChild(planeBollet);
          planeBollets.push(planeBollet);
          this.planeBollets_elements.push(planeBollet);
//        window.PlaneBollets.push(planeBollet);
//        planeBollet.style.top = parseInt(planeBollet.style.top) - 5 + 'px';
//        bolletMove(planeBollets);
          var planeMoveNum = setInterval(planeBolletMove(planeBollets), 1000);
          window.planeMoveNum = planeMoveNum;
        }.bind(this), 500);
        //子弹移动

        window.planeGiveNum = planeGiveNum;

      }
      ;
    };
    var planeBolletMove = function (planeBollets) {
      window.planeBollets = planeBollets;
      for (var i = 0; i < planeBollets.length; i++) {
        planeBollets[i].style.top = parseInt(planeBollets[i].style.top) - 20 + 'px';
        //超出边界清除
        if (parseInt(planeBollets[i].style.top) < 10) {
//            var map = document.getElementById('map');
//            map.removeChild(planeBollets[i]);
//            planeBollets.pop[planeBollets[i]]
          planeBollets[i].remove();
        }
        //打到障碍物
        for (var j = 0; j < HinderBody.length; j++) {
          var planeBollets_x = parseInt(planeBollets[i].style.left) / 5;
          var planeBollets_y = parseInt(planeBollets[i].style.top) / 5;
//            console.log(HinderBody[j].x);
          if (planeBollets_x == HinderBody[j].x && planeBollets_y == HinderBody[j].y) {
//              console.log('击中');
            var scare = document.getElementById('scare');

            if(parseInt(scare.innerText)==100){
              var p = document.getElementsByTagName('p')[0];
              p.className = '';
              p.innerText = '恭喜过关';
            }else {
              scare.innerText = parseInt(scare.innerText) + 10;
            }
            play1.hinder.position();
          }
        }
      }
    };
    window.planeBolletMove = planeBolletMove;
    window.Plane = Plane;
    //检测
//    var p1 = new Plane(document.getElementById('map'));
//    p1.init();
  }());
  //3 障碍物
  (function () {
    function Hinder(options) {
      this.width = options.width || 5;
      this.height = options.height || 5;
      this.body = [
        {x: 0, y: 0},//0
        {x: 1, y: 0},//1
        {x: 2, y: 0},//2
        {x: 3, y: 0},//3
        {x: 4, y: 0},//4
        {x: 5, y: 0},
        {x: 6, y: 0},//6
        {x: 7, y: 0},
        {x: 8, y: 0},//8
        {x: 9, y: 0},
        {x: 10, y: 0},//10
        {x: 0, y: 1},
        {x: 1, y: 1},//12
        {x: 2, y: 1},
        {x: 3, y: 1},//14
        {x: 4, y: 1},
        {x: 5, y: 1},//16
        {x: 6, y: 1},
        {x: 7, y: 1},//18
        {x: 8, y: 1},
        {x: 9, y: 1},//20
        {x: 10, y: 1},
        {x: 1, y: 2},//22
        {x: 2, y: 2},
        {x: 3, y: 2},//24
        {x: 4, y: 2},
        {x: 5, y: 2},//26
        {x: 6, y: 2},
        {x: 7, y: 2},//28
        {x: 8, y: 2},
        {x: 9, y: 2},//30
        {x: 2, y: 3},
        {x: 3, y: 3},//32
        {x: 4, y: 3},
        {x: 5, y: 3},//34
        {x: 6, y: 3},
        {x: 7, y: 3},//36
        {x: 8, y: 3},
        {x: 2, y: 4},//38
        {x: 3, y: 4},
        {x: 4, y: 4},//40
        {x: 5, y: 4},
        {x: 6, y: 4},//42
        {x: 7, y: 4},
        {x: 8, y: 4},//44
        {x: 3, y: 5},
        {x: 4, y: 5},//46
        {x: 6, y: 5},
        {x: 7, y: 5},//48
        {x: 3, y: 6},
        {x: 4, y: 6},//50
        {x: 6, y: 6},
        {x: 7, y: 6},//52
      ];
      this.elements = [];
      this.map = options.map;
      this.direction = '';
    }

    Hinder.prototype.init = function (die) {
      //检查是否有障碍物
      if (this.elements) {
        for (var i = this.elements.length - 1; i >= 0; i--) {
//          this.map.removeChild(this.elements[i]);
          this.elements[i].remove();
        }
      }
      this.elements = [];
      if (!die) {
        for (var i = 0; i < this.body.length; i++) {
          var hinderBody = document.createElement('div');
          hinderBody.style.width = this.width + 'px';
          hinderBody.style.height = this.height + 'px';
          hinderBody.style.backgroundColor = '#666';
          hinderBody.style.left = this.body[i].x * this.width + 'px';
          hinderBody.style.top = this.body[i].y * this.height + 'px';
          var map = document.getElementById('map');
          map.appendChild(hinderBody);
          this.elements.push(hinderBody);
        }
      }

//      this.move();
    };
    //随机障碍物位置
    Hinder.prototype.position = function (die) {
      if (!die) {
//        console.log('新障碍物');
        this.body = [
          {x: 0, y: 0},//0
          {x: 1, y: 0},//1
          {x: 2, y: 0},//2
          {x: 3, y: 0},//3
          {x: 4, y: 0},//4
          {x: 5, y: 0},
          {x: 6, y: 0},//6
          {x: 7, y: 0},
          {x: 8, y: 0},//8
          {x: 9, y: 0},
          {x: 10, y: 0},//10
          {x: 0, y: 1},
          {x: 1, y: 1},//12
          {x: 2, y: 1},
          {x: 3, y: 1},//14
          {x: 4, y: 1},
          {x: 5, y: 1},//16
          {x: 6, y: 1},
          {x: 7, y: 1},//18
          {x: 8, y: 1},
          {x: 9, y: 1},//20
          {x: 10, y: 1},
          {x: 1, y: 2},//22
          {x: 2, y: 2},
          {x: 3, y: 2},//24
          {x: 4, y: 2},
          {x: 5, y: 2},//26
          {x: 6, y: 2},
          {x: 7, y: 2},//28
          {x: 8, y: 2},
          {x: 9, y: 2},//30
          {x: 2, y: 3},
          {x: 3, y: 3},//32
          {x: 4, y: 3},
          {x: 5, y: 3},//34
          {x: 6, y: 3},
          {x: 7, y: 3},//36
          {x: 8, y: 3},
          {x: 2, y: 4},//38
          {x: 3, y: 4},
          {x: 4, y: 4},//40
          {x: 5, y: 4},
          {x: 6, y: 4},//42
          {x: 7, y: 4},
          {x: 8, y: 4},//44
          {x: 3, y: 5},
          {x: 4, y: 5},//46
          {x: 6, y: 5},
          {x: 7, y: 5},//48
          {x: 3, y: 6},
          {x: 4, y: 6},//50
          {x: 6, y: 6},
          {x: 7, y: 6},//52
        ];
        var hinderLeft = Math.floor(Math.random() * 50);
        var hinderTop = Math.floor(Math.random() * 70);
        this.body[0].x = hinderLeft;
        this.body[0].y = hinderTop;
        for (var i = 1; i < this.body.length; i++) {
          if (i <= 10) {
            this.body[i].x = hinderLeft + i;
            this.body[i].y = hinderTop;
          } else if (i <= 21) {
            this.body[i].x = hinderLeft + i - 11;
            this.body[i].y = hinderTop + 1;
          } else if (i <= 30) {
            this.body[i].x = hinderLeft + i - 21;
            this.body[i].y = hinderTop + 2;
          } else if (i <= 37) {
            this.body[i].x = hinderLeft + i - 29;
            this.body[i].y = hinderTop + 3;
          } else if (i <= 44) {
            this.body[i].x = hinderLeft + i - 36;
            this.body[i].y = hinderTop + 4;
          } else if (i <= 46) {
            this.body[i].x = hinderLeft + i - 42;
            this.body[i].y = hinderTop + 5;
          } else if (i <= 48) {
            this.body[i].x = hinderLeft + i - 41;
            this.body[i].y = hinderTop + 5;
          } else if (i <= 50) {
            this.body[i].x = hinderLeft + i - 46;
            this.body[i].y = hinderTop + 6;
          } else if (i <= 52) {
            this.body[i].x = hinderLeft + i - 45;
            this.body[i].y = hinderTop + 6;
          }
        }
        window.HinderBody = this.body;
      } else {
        this.body = [
          {x: 0, y: 0}
        ];
      }
      this.init();
//      this.move(die);
    };
    //创建障碍物子弹
    //障碍物下移
    Hinder.prototype.move = function (die) {
      //检查是否有计时器
//      if(hinderNum){
//        clearInterval(hinderNum);
//        console.log('清除hinderNum');
//      }
//      console.log('hinder-move');
//      clearInterval(hinderNum);
//      console.log(die);
      //移动
      var hinderNum = setInterval(function(die){
        var hiderBody = this.body;
        for (var i = 0; i < hiderBody.length; i++) {
          hiderBody[i].y = this.body[i].y + 1;
          this.init();
//          this.position();
        }
//            console.log(hiderBody);
          //超出边界清除
          if(hiderBody[0].y > 100){
//            this.init();
            for (var i = 0; i < hiderBody.length; i++) {
              this.map.removeChild(this.elements[i]);
//              console.log('超出清除');
              this.position();
//              clearInterval(hinderNum);
//              clearInterval(hinderNum2);
            }
//            this.move(die);
          }

      }.bind(this), 500);
      window.hinderNum = hinderNum;
      if(die){
        clearInterval(hinderNum);
//        console.log('清除hinderNum');
      }
      //超出边界清除
//      if(this.body!=[]){
//        var hinderNum2 = setInterval(function (die) {
////          if (this.body[0].y > 100) {
//////            this.init();
////            for (var i = 0; i < this.body.length; i++) {
////              this.map.removeChild(this.elements[i]);
//////              console.log('超出清除');
////              this.position();
//////              clearInterval(hinderNum);
//////              clearInterval(hinderNum2);
////            }
////            this.move();
////          }
//        }.bind(this), 500);
//        window.hinderNum2 = hinderNum2;
//      }


    };

    window.Hinder = Hinder;
    //检测
//    var h1 = new Hinder(document.getElementById('map'));
//    h1.init();
  }());
  //4 游戏对象
  (function () {
    function Player(options) {
      this.plane = options.plane;
      this.hinder = options.hinder;
      this.map = options.map;
    }

    Player.prototype.init = function (die) {
      if (die == '[]') {
        this.plane.body = [];
        this.hinder.body = [
          {x: 0, y: 0}
        ];
        this.plane.init(die);
//        this.hinder.move(die);
      } else {
        this.plane.init();
        this.plane.move();
        this.plane.bollet();
//      this.hinder.init();
        this.hinder.position();
        this.hinder.move();
        this.direction();
        this.playing();
      }


    };
    Player.prototype.direction = function (die) {
      var that = this;
      if (!die) {
        document.onkeydown = function (e) {
          var e = window.event || e;
          switch (true) {
            case e.keyCode == 37:
              that.plane.direction = 'left';
              break;
            case e.keyCode == 39:
              that.plane.direction = 'right';
              break;
            case e.keyCode == 38:
              that.plane.direction = 'up';
              break;
            case e.keyCode == 40:
              that.plane.direction = 'down';
              break;
          }
//        console.log(that.plane.direction);
          that.plane.move();
        };
      } else {
        document.onkeydown = function () {
          console.log('没有飞机了');
        }
      }

    };
    Player.prototype.playing = function () {

//      障碍物撞到飞机
      var playNum = setInterval(function () {
        var planeLive = play1.plane.live;
        if (planeLive == 0) {
          console.log('发现游戏结束');
          clearInterval(playNum);
//          this.body = [];
//          play1.plane.body=[];
        } else {
          var planeBody = play1.plane.body;
          var hinderBody = play1.hinder.body;
          var flag = false;
          for (var i = 0; i < hinderBody.length; i++) {
            for (var j = 0; j < planeBody.length; j++) {
              if (hinderBody[i].x == planeBody[j].x && hinderBody[i].y == planeBody[j].y) {
//              console.log('击中飞机');
                flag = true;
              }
            }
          }
          if (flag) {
            play1.plane.body = [
              {x: 26, y: 0 + 84},
              {x: 26, y: 1 + 84},
              {x: 26, y: 2 + 84},
              {x: 26, y: 3 + 84},
              {x: 26, y: 4 + 84},
              {x: 26, y: 5 + 84},
              {x: 26, y: 6 + 84},
              {x: 26, y: 7 + 84},
              {x: 26, y: 8 + 84},
              {x: 26, y: 9 + 84},
              {x: 26, y: 10 + 84},
              {x: 26, y: 11 + 84},
              {x: 26, y: 12 + 84},
              {x: 26, y: 13 + 84},
              {x: 26, y: 14 + 84},
              {x: 25, y: 1 + 84},
              {x: 27, y: 1 + 84},
              {x: 25, y: 2 + 84},
              {x: 27, y: 2 + 84},
              {x: 24, y: 3 + 84},
              {x: 25, y: 3 + 84},
              {x: 27, y: 3 + 84},
              {x: 28, y: 3 + 84},
              {x: 23, y: 4 + 84},
              {x: 24, y: 4 + 84},
              {x: 25, y: 4 + 84},
              {x: 27, y: 4 + 84},
              {x: 28, y: 4 + 84},
              {x: 29, y: 4 + 84},
              {x: 22, y: 5 + 84},
              {x: 23, y: 5 + 84},
              {x: 24, y: 5 + 84},
              {x: 25, y: 5 + 84},
              {x: 27, y: 5 + 84},
              {x: 28, y: 5 + 84},
              {x: 29, y: 5 + 84},
              {x: 30, y: 5 + 84},
              {x: 21, y: 6 + 84},
              {x: 22, y: 6 + 84},
              {x: 23, y: 6 + 84},
              {x: 24, y: 6 + 84},
              {x: 25, y: 6 + 84},
              {x: 27, y: 6 + 84},
              {x: 28, y: 6 + 84},
              {x: 29, y: 6 + 84},
              {x: 30, y: 6 + 84},
              {x: 31, y: 6 + 84},
              {x: 20, y: 7 + 84},
              {x: 21, y: 7 + 84},
              {x: 22, y: 7 + 84},
              {x: 23, y: 7 + 84},
              {x: 24, y: 7 + 84},
              {x: 25, y: 7 + 84},
              {x: 27, y: 7 + 84},
              {x: 28, y: 7 + 84},
              {x: 29, y: 7 + 84},
              {x: 30, y: 7 + 84},
              {x: 31, y: 7 + 84},
              {x: 32, y: 7 + 84},
              {x: 25, y: 8 + 84},
              {x: 27, y: 8 + 84},
              {x: 25, y: 9 + 84},
              {x: 27, y: 9 + 84},
              {x: 25, y: 10 + 84},
              {x: 27, y: 10 + 84},
              {x: 25, y: 11 + 84},
              {x: 27, y: 11 + 84},
              {x: 24, y: 12 + 84},
              {x: 25, y: 12 + 84},
              {x: 27, y: 12 + 84},
              {x: 28, y: 12 + 84},
              {x: 23, y: 13 + 84},
              {x: 24, y: 13 + 84},
              {x: 25, y: 13 + 84},
              {x: 27, y: 13 + 84},
              {x: 28, y: 13 + 84},
              {x: 29, y: 13 + 84},
              {x: 22, y: 14 + 84},
              {x: 23, y: 14 + 84},
              {x: 24, y: 14 + 84},
              {x: 25, y: 14 + 84},
              {x: 27, y: 14 + 84},
              {x: 28, y: 14 + 84},
              {x: 29, y: 14 + 84},
              {x: 30, y: 14 + 84},
            ];
            play1.plane.init('#888', 'die');
          }
          ;
        }
      }.bind(this), 500);

    };

    window.Player = Player;
    //检测
//    var play1 = new Player()
  }());
  //开始游戏
  var currentMap = document.getElementById('map');
  var play1 = new Player({
    plane: new Plane({map: currentMap}),
    hinder: new Hinder({map: currentMap}),
    map: currentMap
  });
  var btn = document.getElementById('btn');
  var p = document.getElementsByTagName('p')[0];
  var stop = document.getElementById('stop');
  var flag = true;
  btn.onclick = function () {
    if (flag) {
      p.className = 'active';
      btn.innerText = '重新开始';
      play1.init();
      flag = false;
//      console.log(flag);
    } else {
      location.reload();
      flag = true;
    }
  };
  stop.onclick = function () {
    if (flag == false) {
//        play1.init('[]');
      var p = document.getElementsByTagName('p')[0];
      p.className = '';
      p.innerText = '重新开始';
      flag = true;
    }
  };
  stop.disabled = 'true';
</script>
</body>
</html>